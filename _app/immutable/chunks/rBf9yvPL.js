import{a as b,t as w}from"./BlwcFkRs.js";import{i as M}from"./DqT8BD1v.js";import{h as E,p as Q,a as V,c as r,t as $,r as o,s as d,g as e,B as W,b as X,m as Y}from"./mc_8HRgA.js";import{e as T,s as h}from"./CyaPlrUR.js";import{p as aa,i as U}from"./Cx_dogSh.js";import{e as Z,i as C,g as L,r as j,a as B,A as ta,Z as ea}from"./28jdvDwc.js";import{s as sa}from"./CVP9QBGC.js";import{s as ra,a as D}from"./DwwM9ilA.js";import{p as oa}from"./Uox3awLq.js";import{g as J}from"./BdxA8_O4.js";function ia(t,p,g){var k=t.__className,c=na(p);E&&t.className===c?t.__className=c:(k!==c||E&&t.className!==c)&&(p==null&&!g?t.removeAttribute("class"):t.className=c,t.__className=c)}function na(t,p){return(t??"")+""}var la=w('<div class="whitespace-nowrap"> </div>'),ca=w('<div class="group relative mb-1"><a> </a> <div class="group-hover:block hidden absolute left-full-1 top-0 bg-white dark:bg-gray-800 px-2 py-1 border-default"><div class="whitespace-nowrap"> </div> <!> <div class="whitespace-nowrap text-sm"> </div></div></div>'),va=w('<hr class="mb-1"> <div class="mb-1"><button class="text-left">New Army</button></div> <div><label class="button-default inline-block cursor-pointer relative">Import From File <input class="w-0 opacity-0 text-sm text-left block absolute top-0 left-0" type="file" accept=".json"></label></div>',1),da=w("<div> </div>"),ma=w("<div><!> <!> <!></div>");function Na(t,p){Q(p,!1);const[g,k]=ra(),c=()=>D(B,"$armiesStore",g),R=()=>D(oa,"$page",g);let F=aa(p,"showNewArmyButton",8,!1),q=F()?"editor":"viewer",x=Y([]);M();var A=ma(),O=r(A);Z(O,1,()=>Object.entries(c()).sort((i,a)=>{const s=L(i[1]),n=L(a[1]);return s.localeCompare(n)}),C,(i,a,s)=>{var n=ca(),v=r(n),y=r(v,!0);$(()=>h(y,L(e(a)[1],s))),o(v);var N=d(v,2),l=r(N),m=r(l,!0);o(l);var f=d(l,2);{var u=S=>{var I=la(),K=r(I,!0);o(I),$(()=>h(K,e(a)[1].faction)),b(S,I)};U(f,S=>{e(a)[1].name&&S(u)})}var _=d(f,2),H=r(_);o(_),o(N),o(n),$(()=>{ia(v,`block text-left whitespace-nowrap overflow-hidden text-ellipsis w-64 button-default no-underline normal-color ${(R().params.slug===e(a)[0]?"odd-rows":"")??""}`),sa(v,"href",`/${q??""}/${e(a)[0]??""}`),h(m,e(a)[1].name||e(a)[1].faction||"No Name or Faction"),h(H,`${e(a)[1].maxPoints??""} Points`)}),b(i,n)});var P=d(O,2);{var z=i=>{var a=va(),s=d(W(a),2),n=r(s);o(s);var v=d(s,2),y=r(v),N=d(r(y));o(y),o(v),T("click",n,()=>{const l=j();B.update(m=>({...m,[l]:{faction:"",maxPoints:2e3,name:"",notes:"",units:[]}})),J(`/editor/${l}`)}),T("change",N,async l=>{if(X(x,[]),l.currentTarget.files)for(const m of[...l.currentTarget.files])try{const f=ta.parse(JSON.parse(await m.text()));let u=j();B.update(_=>{for(;Object.keys(_).includes(u);)u=j();return{..._,[u]:f}}),J(`/editor/${u}`)}catch(f){f instanceof ea?e(x).push(`${m.name} doesn't contain an army`):e(x).push(`Error when loading ${m.name}`)}}),b(i,a)};U(P,i=>{F()&&i(z)})}var G=d(P,2);Z(G,1,()=>e(x),C,(i,a)=>{var s=da(),n=r(s,!0);o(s),$(()=>h(n,e(a))),b(i,s)}),o(A),b(t,A),V(),k()}export{Na as L,ia as s};
