import{r as lt,a as H,t as V}from"../chunks/BlwcFkRs.js";import{i as st}from"../chunks/DqT8BD1v.js";import{p as at,c as o,r as i,s as n,t as G,a as et,g as c,u as l,e as K,l as Z,d as ct,B as ut,b as S,I as bt,m as A,n as ht}from"../chunks/mc_8HRgA.js";import{e as J,s as _t}from"../chunks/CyaPlrUR.js";import{p as tt,i as W}from"../chunks/Cx_dogSh.js";import{r as $,s as ot}from"../chunks/CVP9QBGC.js";import{a as N,b as it,o as X}from"../chunks/B6fHHvUj.js";import{s as nt,a as R,b as f}from"../chunks/DwwM9ilA.js";import{p as xt}from"../chunks/Uox3awLq.js";import{g as rt}from"../chunks/BdxA8_O4.js";import{a as d,e as yt,i as wt,g as Y}from"../chunks/28jdvDwc.js";import{s as dt,L as gt}from"../chunks/rBf9yvPL.js";import{A as kt}from"../chunks/DwhWLGHV.js";var Nt=V('<div class="w-prose border-default p-1 even-rows rounded mb-1"><div class="flex flex-row justify-start"><div class="flex-grow"><input class="w-full" type="text" placeholder="Unit Name (e.g. Viridian Company)"></div></div> <div class="flex flex-row justify-start mt-1"><div class="basis-14"><input class="w-full text-right" type="number"></div> <div class="flex-grow ml-1"><input class="w-full" type="text" placeholder="Unit Type (e.g. Soldiers with Pikes)"></div> <div class="basis-16 ml-1"><input class="w-full text-right" type="number"></div></div> <details><summary>Notes</summary> <textarea></textarea></details> <div class="mt-1 flex flex-row"><button class="px-1 cannot-hover:px-2 opaque">‚Æù</button> <button class="ml-1 px-1 cannot-hover:px-2 opaque">‚Æü</button> <button class="ml-1 px-1 cannot-hover:px-2 opaque">√ó2</button> <div class="flex-grow"></div> <button class="ml-1 px-0 cannot-hover:px-2 opaque">üóëÔ∏è</button></div></div>');function $t(E,U){at(U,!1);const[O,F]=nt(),e=()=>R(d,"$armiesStore",O);let a=tt(U,"armyId",8),s=tt(U,"unitId",8);st();var u=Nt(),p=o(u),y=o(p),b=o(y);$(b),i(y),i(p);var I=n(p,2),h=o(I),_=o(h);$(_),i(h);var w=n(h,2),T=o(w);$(T),i(w);var q=n(w,2),M=o(q);$(M),i(q),i(I);var j=n(I,2),z=n(o(j),2);lt(z);const B=K(()=>{var t;return`resize-none w-full ${(((t=e()[a()].units[s()])==null?void 0:t.notes.split(`
`).length)>2?"h-36":"h-16")??""}`});i(j);var g=n(j,2),x=o(g),k=n(x,2),P=n(k,2),D=n(P,4);i(g),i(u),G(()=>{dt(z,c(B)),x.disabled=s()===0,k.disabled=s()===e()[a()].units.length-1}),N(b,()=>e()[a()].units[s()].name,t=>f(d,l(e)[a()].units[s()].name=t,l(e))),N(_,()=>e()[a()].units[s()].size,t=>f(d,l(e)[a()].units[s()].size=t,l(e))),N(T,()=>e()[a()].units[s()].type,t=>f(d,l(e)[a()].units[s()].type=t,l(e))),N(M,()=>e()[a()].units[s()].points,t=>f(d,l(e)[a()].units[s()].points=t,l(e))),N(z,()=>e()[a()].units[s()].notes,t=>f(d,l(e)[a()].units[s()].notes=t,l(e))),J("click",x,()=>{s()!==0&&d.update(t=>{const v=t[a()].units[s()],m=t[a()].units[s()-1];return t[a()].units=t[a()].units.slice(0,s()-1).concat([v,m]).concat(t[a()].units.slice(s()+1,t[a()].units.length)),t})}),J("click",k,()=>{s()!==e()[a()].units.length-1&&d.update(t=>{const v=t[a()].units[s()],m=t[a()].units[s()+1];return t[a()].units=t[a()].units.slice(0,s()).concat([m,v]).concat(t[a()].units.slice(s()+2,t[a()].units.length)),t})}),J("click",P,()=>{d.update(t=>{const v=t[a()].units[s()];return t[a()].units=t[a()].units.slice(0,s()).concat([v,{...v}]).concat(t[a()].units.slice(s()+1,t[a()].units.length)),t})}),J("click",D,()=>{d.update(t=>(t[a()].units=t[a()].units.slice(0,s()).concat(t[a()].units.slice(s()+1,t[a()].units.length)),t))}),H(E,u),et(),F()}var Ut=V('<table class="w-full border-collapse"><tbody><tr><td class="w-min">Army Name</td><td class="flex flex-row"><input class="flex-grow" type="text"></td></tr><tr><td class="w-min">Army Faction</td><td><input class="w-full" type="text"></td></tr><tr><td class="w-min">Army Size</td><td class="text-right"> <input class="text-right w-1/2" type="number"></td></tr><tr><td class="w-min align-text-top">Army Notes</td><td><textarea></textarea></td></tr></tbody></table> <!> <button class="mb-1">Add Unit</button>',1);function It(E,U){at(U,!1);const[O,F]=nt(),e=()=>R(d,"$armiesStore",O),a=A();let s=tt(U,"armyId",8);Z(()=>(e(),bt(s())),()=>{var t;S(a,(t=e()[s()])==null?void 0:t.units.reduce((v,m)=>v+((m==null?void 0:m.points)||0),0))}),ct(),st();var u=Ut(),p=ut(u),y=o(p),b=o(y),I=n(o(b)),h=o(I);$(h),i(I),i(b);var _=n(b),w=n(o(_)),T=o(w);$(T),i(w),i(_);var q=n(_),M=n(o(q)),j=o(M),z=n(j);$(z),i(M),i(q);var B=n(q),g=n(o(B)),x=o(g);lt(x);const k=K(()=>`resize-none w-full ${(e()[s()].notes.split(`
`).length>2?"h-36":"h-16")??""}`);i(g),i(B),i(y),i(p);var P=n(p,2);yt(P,1,()=>e()[s()].units,wt,(t,v,m)=>{$t(t,{get armyId(){return s()},unitId:m})});var D=n(P,2);G(()=>{_t(j,`${c(a)??""} / `),dt(x,c(k))}),N(h,()=>e()[s()].name,t=>f(d,l(e)[s()].name=t,l(e))),N(T,()=>e()[s()].faction,t=>f(d,l(e)[s()].faction=t,l(e))),N(z,()=>e()[s()].maxPoints,t=>f(d,l(e)[s()].maxPoints=t,l(e))),N(x,()=>e()[s()].notes,t=>f(d,l(e)[s()].notes=t,l(e))),J("click",D,()=>{const t={size:1,type:"",name:"",notes:"",points:0};d.update(v=>(v[s()].units=v[s()].units.concat(t),v))}),H(E,u),et(),F()}var qt=V('<a class="ml-1 no-underline opaque button-default">Download</a> <button class="ml-1 px-1 cannot-hover:px-2 opaque">üìã</button>',1),jt=V("<p>Make an army.</p>"),zt=V(`<div class="flex flex-row justify-center"><div class="mr-4"><h2>Lists</h2> <!> <details class="w-64"><summary class="text-xl">Help</summary> <p>The army list is saved on your browser as soon as you make any changes.</p> <p>The larger text boxes for notes use <a href="https://commonmark.org/help/" target="_blank">Markdown</a> with some things like URLs and images disabled. Notably, to get text to appear on a new line,
				you need to insert two new lines or use a list.</p></details></div> <div class="basis-prose mr-4"><div class="flex flex-row items-center"><h1 class="inline">Editor</h1> <div class="flex-grow"></div> <!> <button class="ml-1 px-0 cannot-hover:px-2 opaque">üóëÔ∏è</button></div> <!></div> <div class="basis-prose"><h2>Preview</h2> <table class="mb-2"><tbody><tr><td><label for="preview-show-army-notes-checkbox">Show Army Notes</label></td><td><input id="preview-show-army-notes-checkbox" class="ml-2" type="checkbox"></td></tr><tr><td><label for="preview-show-unit-notes-checkbox">Show Unit Notes</label></td><td><input id="preview-show-unit-notes-checkbox" class="ml-2" type="checkbox"></td></tr></tbody></table> <!></div></div>`);function Vt(E,U){at(U,!1);const[O,F]=nt(),e=()=>R(xt,"$page",O),a=()=>R(d,"$armiesStore",O),s=()=>R(X,"$optionsStore",O),u=A(),p=A();Z(()=>e(),()=>{S(u,e().params.slug)}),Z(()=>(c(u),a()),()=>{S(p,c(u)?a()[c(u)]:null)}),ct(),st();var y=zt(),b=o(y),I=n(o(b),2);gt(I,{showNewArmyButton:!0}),ht(2),i(b);var h=n(b,2),_=o(h),w=n(o(_),4);{var T=r=>{var L=qt(),C=ut(L);G(()=>ot(C,"href",`data:text/json;charset=utf-8,${JSON.stringify(c(p))}`)),G(()=>ot(C,"download",`${Y(c(p)).replaceAll(/[^a-z0-9-]+/gi,"_")}.json`));var Q=n(C,2);J("click",Q,()=>{navigator.clipboard.writeText(JSON.stringify(c(p)))}),H(r,L)};W(w,r=>{c(p)&&r(T)})}var q=n(w,2);i(_);var M=n(_,2);{var j=r=>{It(r,{get armyId(){return c(u)}})},z=r=>{var L=jt();H(r,L)};W(M,r=>{c(u)&&a()[c(u)]?r(j):r(z,!1)})}i(h);var B=n(h,2),g=n(o(B),2),x=o(g),k=o(x),P=n(o(k)),D=o(P);$(D),i(P),i(k);var t=n(k),v=n(o(t)),m=o(v);$(m),i(v),i(t),i(x),i(g);var vt=n(g,2);{var pt=r=>{var L=K(()=>!!s().showArmyNotes),C=K(()=>!!s().showUnitNotes);kt(r,{get army(){return a()[c(u)]},get showArmyNotes(){return c(L)},get showUnitNotes(){return c(C)}})};W(vt,r=>{c(u)&&a()[c(u)]&&r(pt)})}i(B),i(y),J("click",q,()=>{d.update(r=>{if(!c(u))return r;if(delete r[c(u)],Object.entries(r).length>0){const L=Object.entries(r).sort((C,Q)=>{const mt=Y(C[1]),ft=Y(Q[1]);return mt.localeCompare(ft)});rt(`/editor/${L[0][0]}`)}else rt("/editor");return r})}),it(D,()=>s().showArmyNotes,r=>f(X,l(s).showArmyNotes=r,l(s))),it(m,()=>s().showUnitNotes,r=>f(X,l(s).showUnitNotes=r,l(s))),H(E,y),et(),F()}export{Vt as component};
